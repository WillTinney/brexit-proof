<br>

<div class="container-box">
  <div class="progress_bar">
    <hr class="all_steps">
    <hr class="current_steps">
    <div class="step current" id="step1" data-step="1">
        Step 1
    </div>
    <div class="step" id="step2" data-step="2">
        Step 2
    </div>
    <div class="step" id="step3" data-step="3">
        Step 3
    </div>
    <div class="step" id="step4" data-step="4">
        Step 4
    </div>
    <div class="step" id="step5" data-step="5">
        Step 5
    </div>
  </div>

<div id="blocks">
  <div class="block" id="block1" style="left: 0%;">
    <div class="wrap">
      <h2>Block 1</h2>
      <p>Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Cras mattis consectetur purus sit amet fermentum. Aenean lacinia bibendum nulla sed consectetur. Nulla vitae elit libero, a pharetra augue. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
      <br />
      <a onclick="step_process(1, 2)" class="butt">Next</a>
    </div>
  </div>
  <div class="block" id="block2">
    <div class="wrap">
      <h2>Block 2</h2>
      <p>Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Cras mattis consectetur purus sit amet fermentum. Aenean lacinia bibendum nulla sed consectetur. Nulla vitae elit libero, a pharetra augue. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
      <br />
      <a onclick="step_process(2, 3)" class="butt">Next</a>
    </div>
  </div>
  <div class="block" id="block3">
    <div class="wrap">
      <h2>Block 3</h2>
      <p>Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Cras mattis consectetur purus sit amet fermentum. Aenean lacinia bibendum nulla sed consectetur. Nulla vitae elit libero, a pharetra augue. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
      <br />
      <a onclick="step_process(3, 2, 'desc')" class="butt">Prev</a><a onclick="step_process(3, 4)" class="butt">Next</a>
    </div>
  </div>
  <div class="block" id="block4">
    <div class="wrap">
      <h2>Block 4</h2>
      <p>Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Cras mattis consectetur purus sit amet fermentum. Aenean lacinia bibendum nulla sed consectetur. Nulla vitae elit libero, a pharetra augue. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
      <br />
      <a onclick="step_process(4, 5)" class="butt">Next</a>
    </div>
  </div>
  <div class="block" id="block5">
    <div class="wrap">
      <h2>Block 5</h2>
      <p>Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Cras mattis consectetur purus sit amet fermentum. Aenean lacinia bibendum nulla sed consectetur. Nulla vitae elit libero, a pharetra augue. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
      <br />
      Use the progress bar at the top as a navigation back.
    </div>
  </div>
</div>
<br class="clear" />
</div>

<div class="container-box">
  <div class="header-box">
    <h2>Notes for <%= @assignee.first_name.capitalize %></h2>
    <%= link_to "Add New Note", new_user_assignee_note_path(current_user, @assignee, @note), remote: true, class: "btn btn-transparent btn-default button-height-default" %>
  </div>

  <div class="blue-box">
    <p>Here include all notes associated with this <%= @assignee.type %>.</p>
  </div>

  <% @assignee.notes.each do |note| %>
    <div class="col-xs-12 col-md-6">
      <div class="alt-card">
        <div class="note-spacing" id="assignee-note-<%= note.id %>">
          <h5><strong><%= note.title %></strong></h5>
          <p><%= note.content %></p>

          <div class="button-box">
            <%= link_to "Edit", edit_user_assignee_note_path(current_user, @assignee, note.id), remote: true, class: "btn btn-success btn-default" %>
            <%= link_to "Delete", user_assignee_note_path(current_user, @assignee, note.id), data: {confirm: 'Are you sure?'}, method: :delete, class: "btn btn-danger btn-default" %>
          </div>


        </div>
        <div class="note-form" id="edit-note-form-<%= note.id %>"></div>
      </div>
    </div>
  <% end %>

  <div class="col-xs-12 col-md-6">
    <div class="alt-card invisible">
      <div class="note-form" id="new-note-form"></div>
    </div>
  </div>
</div>

<%= content_for(:after_js) do %>
  <script>
    function step_process(from, to, dir) {
        if (typeof(dir) === 'undefined') dir = 'asc';
        var old_move = '';
        var new_start = '';

        var speed = 500;

        if (dir == 'asc') {
            old_move = '-';
            new_start = '';
        } else if (dir == 'desc') {
            old_move = '';
            new_start = '-';
        }

        $('#block'+from).animate({left: old_move+'100%'}, speed, function() {
            $(this).css({left: '100%', 'background-color':'transparent', 'z-index':'2'});
        });
        $('#block'+to).css({'z-index': '3', left:new_start+'100%'}).animate({left: '0%'}, speed, function() {
            $(this).css({'z-index':'2'});
        });

        if (Math.abs(from-to) === 1) {
            // Next Step
            if (from < to) $("#step"+from).addClass('complete').removeClass('current');
            else $("#step"+from).removeClass('complete').removeClass('current');
            var width = (parseInt(to) - 1) * 20;
            $(".progress_bar").find('.current_steps').animate({'width': width+'%'}, speed, function() {
                $("#step"+to).removeClass('complete').addClass('current');
            });
        } else {
            // Move to Step
            var steps = Math.abs(from-to);
            var step_speed = speed / steps;
            if (from < to) {
                move_to_step(from, to, 'asc', step_speed);
            } else {
                move_to_step(from, to, 'desc', step_speed);
            }
        }
    }

    function move_to_step(step, end, dir, step_speed) {
        if (dir == 'asc') {
            $("#step"+step).addClass('complete').removeClass('current');
            var width = (parseInt(step+1) - 1) * 20;
            $(".progress_bar").find('.current_steps').animate({'width': width+'%'}, step_speed, function() {
                $("#step"+(step+1)).removeClass('complete').addClass('current');
                if (step+1 < end) move_to_step((step+1), end, dir, step_speed);
            });
        } else {
            $("#step"+step).removeClass('complete').removeClass('current');
            var width = (parseInt(step-1) - 1) * 20;
            $(".progress_bar").find('.current_steps').animate({'width': width+'%'}, step_speed, function() {
                $("#step"+(step-1)).removeClass('complete').addClass('current');
                if (step-1 > end) move_to_step((step-1), end, dir, step_speed);
            });
        }
    }

    $(document).ready(function() {
        $("body").on("click", ".progress_bar .step.complete", function() {
            var from = $(this).parent().find('.current').data('step');
            var to = $(this).data('step');
            var dir = "desc";
            if (from < to) dir = "asc";

            step_process(from, to, dir);
        });
    });
  </script>
<% end %>
