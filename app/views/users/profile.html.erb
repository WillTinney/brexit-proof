<br><br>

<div class="container-box profile-cards">
  <div class="row">
    <div class="col-xs-12 col-sm-6 col-md-4">
      <div class="alt-card card-overflow black-links <%= "orange-border" unless @user.details_completed? %>" id="details-card">
        <% unless @user.details_completed? %>
            <i class="fa fa-exclamation-circle warning-circle" aria-hidden="true"></i>
          <% end %>
        <h4><%= link_to "My Details", "#" %></h4>
        <hr>
        <div class="card-content">
          <p><strong><%= @user.try(:name_surname) %></strong></p>
          <p><%= @user.citizenship ? @user.citizenship + " Citizen" : "Please enter your citizenship" %></p>
          <p><%= @user.try(:date_of_birth) %></p>
          <p><%= @user.try(:email) %></p>
          <p><%= @user.try(:phone_number) %></p>
          <p><%= @user.try(:address_line_1) %></p>
          <p><%= @user.try(:address_line_2) %></p>
          <p><%= @user.try(:town) %></p>
          <p><%= @user.try(:postcode) %></p>
          <p><%= @user.try(:country) %></p>
          <% unless @user.details_completed? %>
            <i class="fa fa-exclamation-triangle" aria-hidden="true"> Details incomplete</i>
          <% end %>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4">
      <div class="alt-card card-overflow black-links" id="partner-card">
        <h4><%= link_to "My Partner", "#" %></h4>
        <hr>
        <div class="card-content">
          <p><strong><%= link_to @user.partner.try(:name_surname), user_assignee_path(@user, @user.partner) %></strong></p>
          <p><%= @user.partner.try(:address_line_1) %></p>
          <p><%= @user.partner.try(:address_line_2) %></p>
          <p><%= @user.partner.try(:town) %></p>
          <p><%= @user.partner.try(:postcode) %></p>
          <p><%= @user.partner.try(:country) %></p>
          <p><%= @user.partner.try(:phone_number) %></p>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4">
      <div class="alt-card card-overflow black-links" id="children-card">
        <h4><%= link_to "My Children", "#" %></h4>
        <hr>
        <div class="card-content">
          <% @user.children.each do |child| %>
            <p><strong><%= link_to child.try(:name_surname), user_assignee_path(@user, child) %></strong></p>
            <p><%= child.try(:phone_number) %></p>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-xs-12 col-sm-6 col-md-4">
      <div class="alt-card card-overflow black-links" id="guardian-card">
        <h4><%= link_to "My Guardians", "#" %></h4>
        <hr>
        <div class="card-content">
          <% @user.guardians.each do |guardian| %>
            <p><strong><%= link_to guardian.name_surname, user_assignee_path(@user, guardian) %></strong></p>
            <p><%= guardian.try(:phone_number) %></p>
          <% end %>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4">
      <div class="alt-card card-overflow black-links" id="proof-card">
        <h4><%= link_to "Proof of Residency", "#" %></h4>
        <hr>
        <div class="card-content">
          <% @user.proofs.each do |proof| %>
            <p><%= proof.title %></strong></p>
          <% end %>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-6 col-md-4">
      <div class="alt-card card-overflow black-links" id="notes-card">
        <h4><%= link_to "Notes", "#" %></h4>
        <hr>
        <div class="card-content">
          <% @user.notes.each do |note| %>
            <p><%= note.title %> - <strong><%= Assignee.find(note.assignee_id).first_name %></strong></p>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<% content_for(:after_js) do %>
  <script>
    // Clicking on platform icons on profile tab loads tab content
    $('#details-card').click(function(e){
      e.preventDefault();
      $('.sidebar-tabs').children().removeClass('active');
      $('#personal-details-sidebar-tab').addClass('active')
      $.ajax({
          type: "GET",
          url: <%= @user.id %> + "/edit",
          data: { },
          success: function(data){
              $('#tab-content').empty().html(data);
          }
      });
    });
    // $('#partner-card').click(function(e){
    //   e.preventDefault();
    //   $('.sidebar-tabs').children().removeClass('active');
    //   $('#partner-sidebar-tab').addClass('active')
    //   $.ajax({
    //       type: "GET",
    //       url: <%= @user.id %> + "/assignees/" + <%= @user.partner.id %>,
    //       data: { },
    //       success: function(data){
    //           $('#tab-content').empty().html(data);
    //       }
    //   });
    // });
    $('#children-card').click(function(e){
      e.preventDefault();
      $('.sidebar-tabs').children().removeClass('active');
      $('#children-sidebar-tab').addClass('active')
      $.ajax({
          type: "GET",
          url: <%= @user.id %> + "/children",
          data: { },
          success: function(data){
              $('#tab-content').empty().html(data);
          }
      });
    });
    $('#guardian-card').click(function(e){
      e.preventDefault();
      $('.sidebar-tabs').children().removeClass('active');
      $('#guardian-sidebar-tab').addClass('active')
      $.ajax({
          type: "GET",
          url: <%= @user.id %> + "/guardians",
          data: { },
          success: function(data){
              $('#tab-content').empty().html(data);
          }
      });
    });
    $('#proof-card').click(function(e){
      e.preventDefault();
      $('.sidebar-tabs').children().removeClass('active');
      $('#proof-of-residency-sidebar-tab').addClass('active')
      $.ajax({
          type: "GET",
          url: <%= @user.id %> + "/proofs",
          data: { },
          success: function(data){
              $('#tab-content').empty().html(data);
          }
      });
    });
    $('#notes-card').click(function(e){
      e.preventDefault();
      $('.sidebar-tabs').children().removeClass('active');
      $('#notes-sidebar-tab').addClass('active')
      $.ajax({
          type: "GET",
          url: <%= @user.id %> + "/notes",
          data: { },
          success: function(data){
              $('#tab-content').empty().html(data);
          }
      });
    });
    // Clicking on digital assets icon loads tab content
    $('#digital-icon').click(function(e){
      e.preventDefault();
      $('.sidebar-tabs').children().removeClass('active');
      $('#digital-assets-sidebar-tab').addClass('active')
      $.ajax({
          type: "GET",
          url: <%= @user.id %> + "/digital",
          data: { },
          success: function(data){
              $('#tab-content').empty().html(data);
          }
      });
    });
  </script>
<% end %>
